From 4468d347ad7a13689f0b7570f2b66b0dc05051de Mon Sep 17 00:00:00 2001
From: Victor Rodriguez <victor.rodriguez.bahena@intel.com>
Date: Tue, 9 Jan 2018 13:04:29 +0000
Subject: [PATCH] cve-2017-17788

Check for the presence of '\0' before using atoi() on the version
string. Patch slightly modified (mitch).

Based on: 702c4227e8b6169f781e4bb5ae4b5733f51ab126

---
 app/xcf/xcf.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/app/xcf/xcf.c b/app/xcf/xcf.c
index 0ff6ecc..cc56a53 100644
--- a/app/xcf/xcf.c
+++ b/app/xcf/xcf.c
@@ -318,7 +318,8 @@ xcf_load_invoker (GimpProcedure      *procedure,
         {
           info.file_version = 0;
         }
-      else if (id[9] == 'v')
+      else if (id[9]  == 'v' &&
+              id[13] == '\0')
         {
           info.file_version = atoi (id + 10);
         }
-- 
2.15.1

